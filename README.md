
# API. Список стран и городов

REST API, позволяющее управлять списком стран с их городами.


## Задача
Реализовать REST API на фреймворке Laravel последней версии, позволяющее управлять списком стран с их городами.

Сущность “Страна” должна содержать следующую информацию:
1. Двухсимвольный код страны; (Также является первичным ключом в БД)
2. Международный код телефона страны

Сущность “Город” должна содержать следующую информацию:
1. ID;
2. Название;
3. Код страны
Связь между сущностями “Страна” и “Город” один-ко-многим.

API должно отдавать JSON и иметь следующие методы:
1. Получить список всех стран. У каждой страны в ответе от сервера должно быть также поле с названиями его городов; +
2. Создание/редактирование страны;
3. Создание/редактирование городов для страны;
4. Удаление записей;

При создании/редактировании сущности “Страна” на входе обрабатывать следующие поля:
1. Код страны  (обязательно для заполнения, уникальное значение, проверка на реальное существование страны с таким кодом );
2. Код телефона (обязательно, число);

При создании/редактировании сущности “Город” на входе обрабатывать следующие поля:
1. Название города (обязательно для заполнения);

Метод получения списка стран содержит следующие данные:
1. Код страны;
2. Код телефона;
3. Список названий городов;

Возвращать в формате JSON ошибки, возникающие при редактировании/создании/удалении.

Будет плюсом: Написать unit-тесты на каждый API запрос.

Результатом работы должен являться репозиторий (GitHub, BitBucket etc.) с README файлом, в котором описано, 
что вы сделали, что не сделали, но хотели бы (и почему), затраченное время на реализацию.


## Итоговый проект
**Laravel** - 9.40.1

1. Созданы API-роуты (/routes/api.php).
2. Созданы модели Country и City. Связь один-ко-многим. В качестве первичного ключа у модели Country задано поле 'country_code', изменен тип первичного ключа на 'string' и отключен автоинкремент.
3. Созданы файлы миграции, фабрики и сидеры для создания и заполнения БД.
4. Созданы контроллеры CountryController и CityController для обработки запросов.
5. Созданы классы Request для валидации данных при сохранении и обновлении данных.
6. Для валидации кодов стран установлена библиотека league/iso3166 и реализован класс валидации кода страны App\Rules\IsCountryCode.
7. Созданы классы Resource для кастомизации вывода моделей.
8. Настроен вывод ошибок в формате JSON.
9. Добавлены Unit-тесты для всех реализованных методов.
10. Реализована аутентификация по токену.


На выполнение задания потребовалось 8 ч. 


## API

#### GET Authentication Token

```http
  GET /api/setup
```
#### GET All Countries

```http
  GET /api/countries
```

#### GET Country By ID

```http
  GET /api/countries/{countryCode}
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`| `string` | Двухбуквенный код страны |

#### Create Country

```http
  POST /api/countries
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`      | `string` | **Required\|Unique\|IsCountryCode**. Двухбуквенный код страны |
| `phoneCode`      | `string` | **Required\|Numeric\|min1\|max:9999**. Телефонный код страны |


#### Change Country

```http
  PUT|PATCH /api/countries/{countryCode}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`      | `string` | **Unique\|IsCountryCode**. Двухбуквенный код страны |
| `phoneCode`      | `string` | **Numeric\|min1\|max:9999**. Телефонный код страны |

#### Destroy Country

```http
  DELETE /api/countries/{countryCode}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`      | `string` | Двухбуквенный код страны |

#### GET All Cities By Country

```http
  GET /api/countries/{countryCode}/cities
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`      | `string` | Двухбуквенный код страны |

#### GET City By ID

```http
  GET /api/cities/{id}
```
| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `id`| `string` | ID города |

#### Create City By Country

```http
  POST /api/countries/{countryCode}/cities
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `countryCode`      | `string` | Двухбуквенный код страны |
| `name`      | `string` | **Required**. Название города   |


#### Change City

```http
  PUT|PATCH /api/cities/{id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `id`| `string` | ID города |
| `name`      | `string` | **Required**. Название города   |


#### Destroy City

```http
  DELETE /api/cities/{id}
```

| Parameter | Type     | Description                       |
| :-------- | :------- | :-------------------------------- |
| `id`| `string` | ID города |